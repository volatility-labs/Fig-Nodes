# ImageDisplay Node - Feature Documentation

## Overview

The **ImageDisplay Node** is a powerful visualization component designed to display images generated by other nodes in the Fig-Nodes workflow system. It provides an interactive, zoomable, and scrollable interface for viewing single images or multiple images in a grid layout.

## Key Features

### üñºÔ∏è **Multi-Image Support**
- **Single Image Display**: Automatically fits single images within the node bounds while preserving aspect ratio
- **Grid Layout**: Displays multiple images in an intelligent grid layout (automatically calculates optimal rows/columns)
- **Infinite Scrolling**: Seamless infinite scrolling for multi-image grids in both horizontal and vertical directions

### üîç **Zoom Functionality**
- **Zoom Range**: 1.0x (100% original size) to 5.0x (500% zoom)
- **Zoom Control**: Hold **Shift** key and scroll mouse wheel up/down to zoom in/out
- **Smooth Zooming**: Optimized sensitivity for both trackpad and mouse wheel
- **Zoom Limits**: Prevents zooming out beyond original image size (minimum 1.0x)

### üìú **Scroll Functionality**
- **Single Image Scrolling**: Scroll within zoomed images when they exceed the viewport
- **Grid Scrolling**: Infinite scrolling for multi-image grids
- **Scrollbars**: Visual scrollbars appear when content exceeds viewport
- **Mouse Wheel Scrolling**: Natural mouse wheel scrolling support

### üé® **Smart Layout**
- **Aspect Ratio Preservation**: Images maintain their original aspect ratios
- **Auto-Resizing**: Node automatically resizes to match image aspect ratios
- **Responsive Grid**: Grid layout adapts to the number of images
- **Cell Spacing**: Proper spacing between grid cells for clarity

### üîó **Compatibility**
The ImageDisplay Node is compatible with any node that outputs images in the format:
```typescript
{ images: { label: dataUrl } }
```

**Compatible Nodes:**
- **HurstPlot Node** - Displays Hurst spectral analysis charts
- **OHLCVPlot Node** - Displays candlestick charts
- **OHLCVPlotEnhanced Node** - Displays enhanced candlestick charts
- **ImageDisplay Node** - Can be chained for pass-through functionality

## Usage

### Basic Usage
1. Connect any image-generating node (e.g., HurstPlot, OHLCVPlot) to the ImageDisplay Node's `images` input
2. The ImageDisplay Node will automatically render the images
3. Use Shift + scroll to zoom in/out
4. Use mouse wheel to scroll through images

### Multi-Image Workflow
1. Connect a node that outputs multiple images (e.g., HurstPlot with multiple symbols)
2. Images will be displayed in a grid layout
3. Use infinite scrolling to navigate through all images
4. Zoom applies to the entire grid

### Chaining ImageDisplay Nodes
- ImageDisplay Node passes through images, allowing you to chain multiple ImageDisplay nodes
- Useful for creating different views or applying different zoom levels

## Technical Details

### Input Format
```python
inputs = {
    "images": ConfigDict | None  # Dict[str, str] mapping label to base64 data URL
}
```

### Output Format
```python
outputs = {
    "images": ConfigDict  # Pass-through of input images
}
```

### Zoom Implementation
- Zoom level stored as `zoomLevel` property (1.0 to 5.0)
- Applied to both single images and grid cells
- Scroll offsets automatically adjust when zooming

### Scroll Implementation
- Single images: Standard scroll with bounds checking
- Grid images: Infinite scrolling with wrapping offsets
- Scrollbars drawn outside clipped area for visibility

## Keyboard Shortcuts

- **Shift + Scroll Up**: Zoom in
- **Shift + Scroll Down**: Zoom out
- **Mouse Wheel**: Scroll through images (when zoomed or in grid mode)

## Performance

- Images are preloaded and cached for smooth rendering
- Aspect ratios are calculated once and cached
- Canvas redraws are optimized with dirty flag checking
- Efficient grid rendering with viewport culling

## Files

- **Backend**: `nodes/core/market/utils/image_display_node.py`
- **Frontend**: `ui/static/nodes/market/ImageDisplayNodeUI.ts`
- **Export**: `ui/static/nodes/market/index.ts`

## Future Enhancements

Potential future improvements:
- Pan functionality (drag to move zoomed images)
- Zoom to fit button
- Image export functionality
- Thumbnail view mode
- Custom grid layouts

